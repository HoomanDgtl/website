---
import { ChevronDownIcon } from "lucide-react";
import { DocsNav, HomeButton } from "./docs-nav";

const { nav, providersNav } = Astro.props;

const pathname = new URL(Astro.request.url).pathname;

// Icons
const arrowLeftIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>`;

const homeIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>`;

const supportIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><path d="M8 10h.01"/><path d="M12 10h.01"/><path d="M16 10h.01"/></svg>`;
---

<aside
  id="docs-sidebar"
  class="sidebar-scroll sticky top-0 h-[100dhv] w-[260px] flex-shrink-0 overflow-y-auto border-r border-[#e6e8eb] py-6 pl-4 pr-6 dark:border-[#333] lg:w-[280px]"
  style="scroll-behavior: auto;"
>
  <div class="flex flex-col gap-6">
    <!-- Back Link & Logo -->
    <div class="flex flex-col gap-6">
      <!-- Back to akash.network link -->
      <a
        href="/"
        class="group inline-flex items-center gap-1.5 rounded-md px-1 py-1 text-xs font-medium text-[#687076] transition-colors hover:text-[#11181c] dark:text-[#888] dark:hover:text-white"
      >
        <span
          set:html={arrowLeftIcon}
          class="opacity-70 group-hover:opacity-100"
        />
        <span>akash.network</span>
      </a>

      <!-- Logo and DOCS label -->
      <div class="flex items-center gap-1.5">
        <a href="/docs/" class="flex items-center gap-1.5">
          <!-- Akash Logo -->
          <svg
            width="20"
            height="17"
            viewBox="0 0 49 42"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="flex-shrink-0"
          >
            <path
              d="M32.6461 28L40.6323 41.9964H24.5002L16.4297 28H32.6461Z"
              fill="url(#paint0_linear_sidebar)"></path>
            <path
              d="M40.628 41.9977L48.6852 28.0014L32.5575 0.00195312H16.4297L40.628 41.9977Z"
              fill="#FF414C"></path>
            <path
              d="M8.36851 13.9912H24.4963L8.37522 41.9907L0.304688 27.9943L8.36851 13.9912Z"
              fill="#FF414C"></path>
            <defs>
              <linearGradient
                id="paint0_linear_sidebar"
                x1="24.1078"
                y1="31.4804"
                x2="40.5695"
                y2="42.0771"
                gradientUnits="userSpaceOnUse"
              >
                <stop stop-color="#FF414C"></stop>
                <stop offset="1" stop-color="#FF414C" stop-opacity="0"></stop>
              </linearGradient>
            </defs>
          </svg>
          <!-- Akash wordmark -->
          <span class="text-base font-bold text-[#232323] dark:text-white"
            >akash</span
          >
        </a>
        <span class="text-sm font-medium tracking-wide text-[#7e868c]"
          >DOCS</span
        >
      </div>
    </div>

    <!-- Navigation -->
    <div class="flex flex-col gap-5">
      <!-- Divider -->
      <div class="flex flex-col gap-2">
        <div class="h-px w-full bg-[#e6e8eb] dark:bg-[#333]"></div>

        <!-- Home Link -->
        <div>
          <HomeButton pathname={pathname} client:load />
        </div>

        <!-- Divider -->
        <div class="h-px w-full bg-[#e6e8eb] dark:bg-[#333]"></div>
      </div>
      <!-- Docs Navigation -->
      <div>
        <DocsNav
          client:only
          docsNav={nav}
          providersNav={providersNav}
          pathName={pathname}
        >
          <div class="hidden flex-col gap-2 md:flex" slot="fallback">
            {
              nav?.[0]?.subItems?.map((navItem: any, i: any) => (
                <>
                  {i === 0 && (
                    <p class="mt-6 border-t border-[#e6e8eb] py-6 text-xs font-bold uppercase tracking-wider text-[#11181c] dark:border-[#333] dark:text-white">
                      User Docs
                    </p>
                  )}
                  <div
                    class={`flex w-full cursor-pointer items-center justify-between gap-x-2 px-2 py-1 text-sm font-medium`}
                  >
                    <p class="flex-1 text-left text-[#687076] group-hover:text-[#ff414c] dark:text-[#888]">
                      {navItem.label}
                    </p>
                    <ChevronDownIcon className="w-4 text-[#687076]" />
                  </div>
                </>
              ))
            }
          </div>
        </DocsNav>
      </div>

      <!-- Divider -->
      <div class="h-px w-full bg-[#e6e8eb] dark:bg-[#333]"></div>

      <!-- Support Link -->
      <div>
        <a
          href="/support/"
          class={`flex cursor-pointer items-center gap-x-2 rounded-md px-3 py-1.5 text-sm font-medium leading-[20px] transition-colors hover:bg-[#f5f5f5] dark:hover:bg-[#333] ${
            pathname === "/support/"
              ? "bg-[#fff1f2] text-[#ff414c] dark:bg-[#3a1d1f]"
              : "text-[#687076] dark:text-[#888]"
          }`}
        >
          <span set:html={supportIcon} />
          Support
        </a>
      </div>
    </div>
  </div>
</aside>
